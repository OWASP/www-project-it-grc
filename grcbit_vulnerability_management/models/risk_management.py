from odoo import models, fields

class RiskFactorVulnerability(models.Model):
    _inherit = 'risk.factor'
    common_vulnerability_exposure_ids = fields.One2many('risk.factor.vulnerability.management', 'risk_factor_id', string='Risk Factor', auto_join=True)

class RiskFactorVulnerabilityManagement(models.Model):
    _name = 'risk.factor.vulnerability.management'
    _description = 'Risk Factor Vulnerability Management'
    _rec_name = 'risk_factor_id'

    risk_factor_id = fields.Many2one('risk.factor', string='Risk Factor')
    cve_id = fields.Many2one('common.vulnerability.exposure', string='CVE')
    #vulnerability_id = fields.Char(string='Vulnerability ID')
    vulnerability_name = fields.Char(string='Vulnerability Name')
    detection_date = fields.Date(string='Detection Date', default=fields.Date.today)
    detection_source = fields.Selection([('pentest','Pentest'),('scanning','Scanning'),('internal_audit','Internal Audit'),('user_report','User Report')])
    description  = fields.Html(string='Description')
    cvss_score_3 = fields.Float(string="CVSS-3 Score", digits=(1,1))
    cvss_string_3 = fields.Char(string="CVSS-3 Vector")
    vulnerability_status = fields.Selection([('new','New/Identified'),('under_review','Under Review'),('confirmed','Confirmed'),('risk_assessed','Risk Assessed'), ('in_progress','Mitigation in Progress'), ('patch_available','Patch Available'), ('remediated','Remediated'), ('closed','Closed'), ('reopened','Reopened')])
