<?xml version="1.0" encoding="utf-8" ?>
<odoo>
  <data>
    <!--       CONTROL DESIGN       -->
    <record id="control_design_action" model="ir.actions.act_window">
	    <field name="name">Control Design</field>
	    <field name="res_model">control.design</field>
	    <field name="view_mode">tree,form,graph,kanban</field>
    </record>
    <record model="ir.ui.view" id="control_design_view">
      <field name="name">Control Design</field>
      <field name="model">control.design</field>
      <field name="arch" type="xml">
        <tree multi_edit="1">
          <field name="active" invisible="1"  />
          <field name="control_id" widget="badge" />
          <field name="name" />
          <field name="description"  />
          <field name="estimated_date"  widget="remaining_days" />
          <field name="control_design_criteria_id" optional="True" />
          <field name="control_evaluation_criteria_id" optional="True" />
          <field name="is_key_control" widget="boolean_toggle" attrs="{'readonly': [('state', 'not in', ['draft'])] }" />
          <field name="risk_factor_id" widget="many2many_tags_open" />
          <field name="state" widget="badge" decoration-info="1" />  
          <field name="responsible" widget="many2one_avatar_user" optional="hide"/>
          <field name="control_type_id" widget="many2many_tags_open" optional="hide" />
          <field name="security_property_id" widget="many2many_tags_open" optional="hide" />
          <field name="cybersecurity_concept_id" widget="many2many_tags_open" optional="hide" />
          <field name="operational_capability_id" widget="many2many_tags_open" optional="hide" />
          <field name="security_domain_id" widget="many2many_tags_open" optional="hide" />
          <field name="design_date" readonly="1" force_save="1" optional="hide" />
          <field name="implementation_date" readonly="1" force_save="1" optional="hide" />
          <field name="approve_date" readonly="1" force_save="1" optional="hide" />
          <field name="rejected_date" readonly="1" force_save="1" optional="hide" />
        </tree>
      </field>
    </record>
    <record model="ir.ui.view" id="control_design_search">
      <field name="name">Control Design</field>
      <field name="model">control.design</field>
      <field name="arch" type="xml">
        <search>
          <field name="risk_factor_id" widget="many2many_tags_open" />
          <field name="name" />
          <field name="control_design_criteria_id"  />
          <field name="control_evaluation_criteria_id"  />
          <field name="description"  />
          <field name="evidence_guide" />
          <field name="responsible" />
          <field name="control_type_id" />
          <field name="security_property_id" />
          <field name="cybersecurity_concept_id" />
          <field name="operational_capability_id" />
          <field name="security_domain_id" />
        </search>
      </field>
    </record>
    <record model="ir.ui.view" id="control_design_form">
      <field name="name">Control Design</field>
      <field name="model">control.design</field>
      <field name="arch" type="xml">
        <form>
		      <sheet>
	          <header>
              <field name="state" widget="statusbar" options="{'clickable':'1'}" />
              <button name="action_draft" string="SET TO DRAFT" type="object"  class="btn-primary" groups="grcbit_base.group_grc_admin, grcbit_base.group_grc_consultant" confirm="¿Esta seguro que quiere pasar a la fase de BORRADOR de CONTROL?" attrs="{'invisible': [('state','in',['draft'])] }" />
              <button name="action_design" string="CONFIRM" type="object" attrs="{'invisible': [('state', 'not in', ['draft'])]}" class="btn-success" groups="grcbit_base.group_grc_admin, grcbit_base.group_grc_consultant" confirm="¿Esta seguro que quiere aprobar el  DISEÑO de CONTROL?" />
              <button name="action_implemented" string="CONFIRM" type="object" attrs="{'invisible': [('state', 'not in', ['designed'])]}" class="btn-success" groups="grcbit_base.group_grc_admin, grcbit_base.group_grc_consultant, grcbit_base.group_risk_owner" confirm="¿Esta seguro que quiere concluir la IMPLEMENTACION de CONTROL?" />
              <button name="action_approved" string="CONFIRM" type="object" attrs="{'invisible': [('state', 'not in', ['implemented'])]}" class="btn-success" groups="grcbit_base.group_grc_admin, grcbit_base.group_grc_consultant" confirm="¿Esta seguro que quiere APROBAR la IMPLEMENTACION de CONTROL?" />
              <button name="action_rejected" string="REJECT" type="object" attrs="{'invisible': [('state', 'not in', ['implemented'])]}" class="btn-success" groups="grcbit_base.group_grc_admin, grcbit_base.group_grc_consultant" confirm="¿Esta seguro que quiere RECHAZAR la IMPLEMENTACION de CONTROL?" />
  		      </header>
	  	      <group>
              <field name="active" invisible="1"  />
              <field name="risk_factor_id" widget="many2many_tags_open" options="{'no_quick_create': True, 'no_create_edit' : True, 'no_create':True}" attrs="{'readonly': [('state', 'not in', ['draft'])] }" />
              <field name="name" attrs="{'readonly': [('state', 'not in', ['draft'])] }" />
              <field name="description" attrs="{'readonly': [('state', 'not in', ['draft'])] }" />
	            <field name="estimated_date" />
              <field name="control_line_ids" widget="section_and_note_one2many" mode="tree" attrs="{ 'readonly': [('state', 'not in', ('draft', 'implemented') )] }"  >
                <form>
                  <field name="active" invisible="1" />
                  <field name="control_design_id" invisible="1" />
                  <group>
                    <field name="name" />
                    <field name="description"  />
                    <field name="control_periodicity" />
                    <field name="attachment" widget="many2many_binary" />
	                  <field name="is_implemented"  widget="boolean_toggle"  />
                  </group>
                </form>
                <tree>
                  <field name="active" invisible="1" />
                  <field name="control_design_id" invisible="1" />
                  <field name="name" />
                  <field name="description" optional="hide" />
                  <field name="control_periodicity" />
                  <field name="attachment" widget="many2many_binary"  />
                  <field name="is_implemented"  widget="boolean_toggle"  />
                </tree>
              </field>      
              <field name="control_design_criteria_id" groups="grcbit_base.group_grc_admin, grcbit_base.group_grc_consultant" attrs="{'readonly': [('state', 'not in', ['designed'])]}"  />
              <field name="control_evaluation_criteria_id" groups="grcbit_base.group_grc_admin, grcbit_base.group_grc_consultant" attrs="{'readonly': [('state', 'not in', ['implemented'])]}"  />
              <field name="is_key_control" widget="boolean_toggle" attrs="{'readonly': [('state', 'not in', ['draft'])] }" />
              <field name="responsible" widget="many2one_avatar_user" optional="hide" attrs="{'readonly': [('state', 'not in', ['draft'])] }" options="{'no_quick_create': True, 'no_create_edit' : True, 'no_create':True}" />
              <field name="control_type_id" widget="many2many_tags_open" options="{'no_quick_create': True, 'no_create_edit' : True, 'no_create':True}" attrs="{'readonly': [('state', 'not in', ['draft'])] }" />
              <field name="security_property_id" widget="many2many_tags_open" options="{'no_quick_create': True, 'no_create_edit' : True, 'no_create':True}"  attrs="{'readonly': [('state', 'not in', ['draft'])] }" />
            </group>
		        <group>
              <field name="cybersecurity_concept_id" widget="many2many_tags_open" options="{'no_quick_create': True, 'no_create_edit' : True, 'no_create':True}"  attrs="{'readonly': [('state', 'not in', ['draft'])] }" />
              <field name="operational_capability_id" widget="many2many_tags_open" options="{'no_quick_create': True, 'no_create_edit' : True, 'no_create':True}"  attrs="{'readonly': [('state', 'not in', ['draft'])] }" />
              <field name="security_domain_id" widget="many2many_tags_open" options="{'no_quick_create': True, 'no_create_edit' : True, 'no_create':True}" attrs="{'readonly': [('state', 'not in', ['draft'])] }" />
              <field name="design_date" readonly="1" force_save="1" />
              <field name="implementation_date" readonly="1" force_save="1" />
              <field name="approve_date" readonly="1" force_save="1" />
              <field name="rejected_date" readonly="1" force_save="1" />
            </group>
            <notebook>
              <page string="Control Evidences" name="control_evidence_page">
                <field name="control_evidence_ids" widget="section_and_note_one2many" mode="tree" attrs="{ 'readonly': [('state', 'not in', ('designed') )] }" >
                  <form>
                    <field name="active" invisible="1" />
                    <field name="control_design_id" invisible="1" />
                    <group>
                      <field name="name" />
                      <field name="comment" />
                      <field name="attachment" widget="many2many_binary" />
                    </group>
                  </form>
                  <tree>
                    <field name="active" invisible="1" />
                    <field name="control_design_id" invisible="1" />
                    <field name="name" />
                    <field name="comment" />
                    <field name="attachment" widget="many2many_binary" />
                  </tree>
                </field>      
              </page>
            </notebook>
	        </sheet>
          <div class="oe_chatter">
            <field name="message_follower_ids" widget="mail_followers"/>
            <field name="message_ids" widget="mail_thread"/>
          </div>
        </form>
      </field>
    </record>
    <record model="ir.ui.view" id="control_design_kanban">
      <field name="name">Control Design</field>
      <field name="model">control.design</field>
      <field name="arch" type="xml">
	      <kanban class="o_kanban_mobile">
          <field name="name"/>
          <field name="description"/>
          <templates>
            <t t-name="kanban-box">
              <div t-attf-class="oe_kanban_global_click">
                <div class="oe_kanban_details">
                  <strong class="o_kanban_record_title">
                    <field name="name"/>
                  </strong>
                  <div>
                    <t t-esc="record.description.value"/>
		              </div>
                </div>
              </div>
            </t>
          </templates>
        </kanban>
      </field>
    </record>
    <record model="ir.ui.view" id="control_design_graph">
      <field name="name">Control Design</field>
      <field name="model">control.design</field>
      <field name="type">graph</field>
      <field name="arch" type="xml">
        <graph type="bar" >
          <field name="display_name" />
          <field name="name" />
          <field name="risk_factor_id" />
          <field name="state" />
        </graph>
      </field>
    </record>

    <!--       CONTROL DESIGN CRITERIA       -->
    <record id="control_design_criteria_action" model="ir.actions.act_window">
	    <field name="name">Design Criteria</field>
	    <field name="res_model">control.design.criteria</field>
	    <field name="view_mode">tree,form,kanban</field>
    </record>
    <record model="ir.ui.view" id="control_design_criteria_view">
      <field name="name">Design Criteria</field>
      <field name="model">control.design.criteria</field>
      <field name="arch" type="xml">
        <tree multi_edit="1">
          <field name="name" />
          <field name="description" />
        </tree>
      </field>
    </record>
    <record model="ir.ui.view" id="control_design_criteria_form">
      <field name="name">Design Criteria</field>
      <field name="model">control.design.criteria</field>
      <field name="arch" type="xml">
        <form>
		      <group>
            <field name="name" />
            <field name="description" />
          </group>
        </form>
      </field>
    </record>
    <record model="ir.ui.view" id="control_design_criteria_kanban">
      <field name="name">Design Criteria</field>
      <field name="model">control.design.criteria</field>
      <field name="arch" type="xml">
	      <kanban class="o_kanban_mobile">
          <field name="name"/>
          <field name="description"/>
          <templates>
            <t t-name="kanban-box">
              <div t-attf-class="oe_kanban_global_click">
                <div class="oe_kanban_details">
                  <strong class="o_kanban_record_title">
                    <field name="name"/>
                  </strong>
                  <div>
                    <t t-esc="record.description.value"/>
		              </div>
                </div>
              </div>
            </t>
          </templates>
        </kanban>
      </field>
    </record>

    <!--       CRONTROL EVALUATION CRITERIA       -->
    <record id="control_evaluation_criteria_action" model="ir.actions.act_window">
	    <field name="name">Implementation Criteria</field>
	    <field name="res_model">control.evaluation.criteria</field>
	    <field name="view_mode">tree,form,kanban</field>
    </record>
    <record model="ir.ui.view" id="control_evaluation_criteria_view">
      <field name="name">Implementation Criteria</field>
      <field name="model">control.evaluation.criteria</field>
      <field name="arch" type="xml">
        <tree multi_edit="1">
          <field name="name" />
          <field name="description" />
        </tree>
      </field>
    </record>
    <record model="ir.ui.view" id="control_evaluation_criteria_form">
      <field name="name">Implementation Criteria</field>
      <field name="model">control.evaluation.criteria</field>
      <field name="arch" type="xml">
        <form>
	      	<group>
            <field name="name" />
            <field name="description" />
          </group>
        </form>
      </field>
    </record>
    <record model="ir.ui.view" id="control_evaluation_criteria_kanban">
      <field name="name">Implementation Criteria</field>
      <field name="model">control.evaluation.criteria</field>
      <field name="arch" type="xml">
	      <kanban class="o_kanban_mobile">
          <field name="name"/>
          <field name="description"/>
          <templates>
            <t t-name="kanban-box">
              <div t-attf-class="oe_kanban_global_click">
                <div class="oe_kanban_details">
                  <strong class="o_kanban_record_title">
                    <field name="name"/>
                  </strong>
                  <div>
                    <t t-esc="record.description.value"/>
		              </div>
                </div>
              </div>
            </t>
          </templates>
        </kanban>
      </field>
    </record>

    
  </data>
</odoo>