(this["webpackJsonppowerbi-embedded-sample"]=this["webpackJsonppowerbi-embedded-sample"]||[]).push([[0],{174:function(e,t,r){e.exports=r(373)},372:function(e,t,r){},373:function(e,t,r){"use strict";r.r(t);r(175),r(184);var o,n,s,i,c,a,d,l=r(43),u=r.n(l),m=r(169),I=r.n(m),h=r(170),p=r(171),k=r(173),y=r(172),Z=r(375),U=r(49),b=(r(372),["https://analysis.windows.net/powerbi/api/Report.Read.All"]),W=null===(o=document.getElementById("clientId"))||void 0===o?void 0:o.className,F=null===(n=document.getElementById("reportId"))||void 0===n?void 0:n.className,T=null===(s=document.getElementById("workspaceId"))||void 0===s?void 0:s.className,N=null===(i=document.getElementById("url"))||void 0===i?void 0:i.className,f=new U.service.Service(U.factories.hpmFactory,U.factories.wpmpFactory,U.factories.routerFactory),Y="eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IjJaUXBKM1VwYmpBWVhZR2FYRUpsOGxWMFRPSSIsImtpZCI6IjJaUXBKM1VwYmpBWVhZR2FYRUpsOGxWMFRPSSJ9.eyJhdWQiOiJodHRwczovL2FuYWx5c2lzLndpbmRvd3MubmV0L3Bvd2VyYmkvYXBpIiwiaXNzIjoiaHR0cHM6Ly9zdHMud2luZG93cy5uZXQvYjY3MWZiZDEtZTI5Mi00NWVlLTkwYzYtODM2ODczMWU5MWI4LyIsImlhdCI6MTY1ODg3MzAyMSwibmJmIjoxNjU4ODczMDIxLCJleHAiOjE2NTg4NzgzMTUsImFjY3QiOjAsImFjciI6IjEiLCJhaW8iOiJFMlpnWUpqMm04RlBLYXRmZGNVMDFaaHpmSm9wMGZldUwvYlZPeVhWc25kaFRLUkp6SDhBIiwiYW1yIjpbInB3ZCJdLCJhcHBpZCI6ImIyNGQ2YjRjLTE3NDQtNDU4My05ZmViLTE5NGFkZDNjOTY0MSIsImFwcGlkYWNyIjoiMCIsImZhbWlseV9uYW1lIjoiQWdhcndhbCIsImdpdmVuX25hbWUiOiJOaWtoaWwiLCJpcGFkZHIiOiIxMy4yMzUuNTEuMTg0IiwibmFtZSI6Ik5pa2hpbCBBZ2Fyd2FsIiwib2lkIjoiMDIxZTAwYzctZTc2Yy00YzM0LTgwY2EtYTc4YzU0NDRiMjVlIiwicHVpZCI6IjEwMDMyMDAxNTVCRTk3MTQiLCJyaCI6IjAuQVZBQTBmdHh0cExpN2tXUXhvTm9jeDZSdUFrQUFBQUFBQUFBd0FBQUFBQUFBQUJRQUowLiIsInNjcCI6IkFwcC5SZWFkLkFsbCBDYXBhY2l0eS5SZWFkLkFsbCBDYXBhY2l0eS5SZWFkV3JpdGUuQWxsIENvbnRlbnQuQ3JlYXRlIERhc2hib2FyZC5SZWFkLkFsbCBEYXNoYm9hcmQuUmVhZFdyaXRlLkFsbCBEYXRhZmxvdy5SZWFkLkFsbCBEYXRhZmxvdy5SZWFkV3JpdGUuQWxsIERhdGFzZXQuUmVhZC5BbGwgRGF0YXNldC5SZWFkV3JpdGUuQWxsIEdhdGV3YXkuUmVhZC5BbGwgR2F0ZXdheS5SZWFkV3JpdGUuQWxsIFJlcG9ydC5SZWFkLkFsbCBSZXBvcnQuUmVhZFdyaXRlLkFsbCBTdG9yYWdlQWNjb3VudC5SZWFkLkFsbCBTdG9yYWdlQWNjb3VudC5SZWFkV3JpdGUuQWxsIFdvcmtzcGFjZS5SZWFkLkFsbCBXb3Jrc3BhY2UuUmVhZFdyaXRlLkFsbCIsInN1YiI6IlFKNkgtMmR4dlpDd2lycmR5RU9vU0FGQUlrdjNoV3ZWTWtFOS1BS0l2bGsiLCJ0aWQiOiJiNjcxZmJkMS1lMjkyLTQ1ZWUtOTBjNi04MzY4NzMxZTkxYjgiLCJ1bmlxdWVfbmFtZSI6IlRlY2huZWl0aEBUZWNobmVpdGgxLm9ubWljcm9zb2Z0LmNvbSIsInVwbiI6IlRlY2huZWl0aEBUZWNobmVpdGgxLm9ubWljcm9zb2Z0LmNvbSIsInV0aSI6IjZjdlhlYXpYZ2thVnhuNkhMOUlOQUEiLCJ2ZXIiOiIxLjAiLCJ3aWRzIjpbImE5ZWE4OTk2LTEyMmYtNGM3NC05NTIwLThlZGNkMTkyODI2YyIsIjYyZTkwMzk0LTY5ZjUtNDIzNy05MTkwLTAxMjE3NzE0NWUxMCIsIjExNjQ4NTk3LTkyNmMtNGNmMy05YzM2LWJjZWJiMGJhOGRjYyIsImI3OWZiZjRkLTNlZjktNDY4OS04MTQzLTc2YjE5NGU4NTUwOSJdfQ.SzvKyHIIyg7U4N79XdPNuPH_JfDNXICFtYpo5LXupwHnC9HI0GMHv-BfX4Sm_yH_T3dkMKSly0ZQ96kK6W_6g0uGm_vCeH6Wmz0X9gYCknxrWLRNVsKqJ922JW3SYA9ULAk7Ap0s7uUeaUEcOCLyT5oc2PPCZYLXI6xNR56klEeLc9oUusUn0njIv9RSLfljzrksd1glzq_S2Tb8aCQWAGtcu9P7_-kdLVwq76wirQr5yqyXDbEXc1Hw6_W0O7T2zTj9QJ8N3pdzhe_DPS3k_uL2yT4KfZt3OI_GI7ZN6FL3maNU2ygifxUvuWtfoTKFzn7qhDwfKG-eTEv_u6JV7A",L=N,C=function(e){Object(k.a)(r,e);var t=Object(y.a)(r);function r(e){var o;return Object(h.a)(this,r),(o=t.call(this,e)).state={report_id:"",accessToken:"",embedUrl:"",error:[]},a=u.a.createRef(),d=u.a.createElement("div",{id:"reportContainer",ref:a},"Loading the report..."),o}return Object(p.a)(r,[{key:"render",value:function(){if(this.state.error.length)c.textContent="",this.state.error.forEach((function(e){c.appendChild(document.createTextNode(e)),c.appendChild(document.createElement("br"))}));else if(""!==this.state.accessToken&&""!==this.state.embedUrl){var e={type:"report",tokenType:U.models.TokenType.Aad,accessToken:Y,embedUrl:L,id:F},t=f.embed(c,e);t.off("loaded"),t.on("loaded",(function(){console.log("Report load successful")})),t.off("rendered"),t.on("rendered",(function(){console.log("Report render successful")})),t.off("error"),t.on("error",(function(e){var t=e.detail;console.error(t)}))}return d}},{key:"componentDidMount",value:function(){null!==a&&(c=a.current),""===T||""===F?this.setState({error:["Please assign values to workspace Id and report Id in Config.ts file"]}):this.authenticate()}},{key:"componentWillUnmount",value:function(){f.reset(c)}},{key:"authenticate",value:function(){var e=this,t=this,r={auth:{clientId:W}},o={scopes:b},n=new Z.a(r);n.handleRedirectCallback((function(e){"id_token"===e.tokenType?t.authenticate():"access_token"===e.tokenType?(Y=e.accessToken,t.setUsername(e.account.name),t.tryRefreshUserPermissions(),t.getembedUrl()):t.setState({error:["Token type is: "+e.tokenType]})}),(function(e){t.setState({error:["Redirect error: "+e]})})),n.getAccount()?n.acquireTokenSilent(o).then((function(t){Y=t.accessToken,e.setUsername(t.account.name),e.getembedUrl()})).catch((function(e){"InteractionRequiredAuthError"===e.name?n.acquireTokenRedirect(o):t.setState({error:[e.toString()]})})):n.loginRedirect(o)}},{key:"tryRefreshUserPermissions",value:function(){fetch("https://api.powerbi.com/v1.0/myorg/RefreshUserPermissions",{headers:{Authorization:"Bearer "+Y},method:"POST"}).then((function(e){e.ok?console.log("User permissions refreshed successfully."):429===e.status?console.error("Permissions refresh will be available in up to an hour."):console.error(e)})).catch((function(e){console.error("Failure in making API call."+e)}))}},{key:"getembedUrl",value:function(){var e=this;fetch("https://api.powerbi.com/v1.0/myorg/groups/"+T+"/reports/"+F,{headers:{Authorization:"Bearer "+Y},method:"GET"}).then((function(t){var r=[];r.push("Error occurred while fetching the embed URL of the report"),r.push("Request Id: "+t.headers.get("requestId")),t.json().then((function(o){t.ok?(L=o.embedUrl,e.setState({accessToken:Y,embedUrl:L})):(r.push("Error "+t.status+": "+o.error.code),e.setState({error:r}))})).catch((function(){r.push("Error "+t.status+":  An error has occurred"),e.setState({error:r})}))})).catch((function(t){e.setState({error:t})}))}},{key:"setUsername",value:function(e){var t=document.getElementById("welcome");null!==t&&(t.innerText="Welcome, "+e)}}]),r}(u.a.Component);I.a.render(u.a.createElement(C,null),document.getElementById("root"))}},[[174,1,2]]]);
//# sourceMappingURL=main.c3ffdf12.chunk.js.map